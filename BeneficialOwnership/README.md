# Steps to Run the Beneficial Ownership Engine

1. Make sure all Beneficial Ownership Engine input data files are in the curated zone, under a single subfolder, in .csv format. These files are generated by ingestion of the open source datasets to the raw zone and triggering the Consumer Synapse pipeline 'PL_BO_Part1_FlattenAndValidate'. This pipeline will store the required Beneficial Ownership Engine data in the Beneficial Ownership Model in the Consumer Synapse, and save the required csv files. The Beneficial Ownership Model includes Activity, Contact, Ownership, AttributeDefinition, RedFlagDefinition, and EntityWeight tables and is provided so that these data can be queried. The Beneficial Ownership Engine requires only the csv files as inputs.
2. Make sure the .whl and .env file are installed on the Spark cluster that will be used to run the Beneficial Ownership notebook
3. In the notebook, update the variables of folderpath, storagename, and datecountry:
    - **folderpath** needs to match the subfolder name in the curated zone where the .csv are placed, 
    - **storagename** is the storage account name, and 
    - **datecountry** is the name of the lake database where the final reports will be generated, as specified by the user. If datecountry is not changed, the data will be overwritten in the subsequent run.

NOTE: For the sample Dominican Republic data, trigger the Synapse pipeline with notebook 'NB_Run_Transparency_Engine_DR.ipynb'. The activity file for this dataset contains 'item' and 'tenderer information', not 'buyer' or 'lot', so its configuration file was modified from the original NB_Run_Transparency_Engine.ipynb notebook.

Results will be stored in the Synapse lake database and the Power BI report must point to this Synapse workspace and database name in order to display visualize the results. See [Downloading and Using the Procurement and Beneficial Ownership Reports](DemoReports\README.md) for details on using the example Power BI report.
